#!/usr/bin/python
# To easily customize Basis set of a GAMESS .nip file


# importing modules
import sys
import os
import re

# display menu

print ("\n ~~~~ WELCOME TO GAMESS Basis Set CUSTOMIZER ~~~~\n")

message = ("To Run: python insert_BS file_name.inp\nFor now only adds CUSTOMA2.")
print message

# Verify input
if len(sys.argv) <= 1:
	path = raw_input("Enter path to log file: ")
else:
	path = sys.argv[1]
	if not os.path.isfile(path):
		sys.exit("This file does not exist.Bye!")

# CUSTOMA2 basis set:

FE = """ S   6		
  1  61132.6200000              1.766111E-03     
  2   9179.3420000              1.353038E-02     
  3   2090.8570000              6.673128E-02     
  4    589.2479000              2.314823E-01     
  5    188.7543000              4.797058E-01     
  6     64.4462900              3.501976E-01     
 L   6
  1   1259.9800000              2.438014E-03           4.028019E-03     
  2    299.8761000              3.224048E-02           3.144647E-02     
  3     96.8491700              1.265724E-01           1.368317E-01     
  4     36.3102000             -3.139902E-02           3.487236E-01     
  5     14.7299600             -6.207593E-01           4.617931E-01     
  6      6.0660750             -4.502914E-01           2.043058E-01     
 L   6
  1     50.4348500             -3.873256E-03          -7.017128E-03     
  2     16.8392900              7.196598E-02          -2.877660E-02     
  3      7.1920860              2.556591E-01           6.181383E-02     
  4      3.0534200             -2.882837E-01           3.954946E-01     
  5      1.2736430             -7.342822E-01           4.989059E-01     
  6      0.5040910             -2.049353E-01           1.791251E-01     
 L   3
  1      1.9503160              0.05694869            -0.4593796        
  2      0.7367210              0.2882915              0.2852139        
  3      0.1141770             -1.1381590              0.9076485        
 L   1
  1      0.0411480              1.000000E+00           1.00000000       
 D   3
  1     23.1499400              8.876935E-02     
  2      6.1223680              3.896319E-01     
  3      1.8466010              7.014816E-01     
 D   1
  1      0.5043610              1.0000000  
  
"""
C = """ S   6
  1   3047.5249000              0.0018347        
  2    457.3695100              0.0140373        
  3    103.9486900              0.0688426        
  4     29.2101550              0.2321844        
  5      9.2866630              0.4679413        
  6      3.1639270              0.3623120        
 L   3
  1      7.8682724             -0.1193324              0.0689991        
  2      1.8812885             -0.1608542              0.3164240        
  3      0.5442493              1.1434564              0.7443083        
 L   1
  1      0.1687144              1.0000000              1.0000000 
  
"""
H = """ S   3
  1     18.7311370              0.03349460       
  2      2.8253937              0.23472695       
  3      0.6401217              0.81375733       
 S   1
  1      0.1612778              1.0000000  

"""  
N = """ S   6
  1   4173.5110000              0.0018348        
  2    627.4579000              0.0139950        
  3    142.9021000              0.0685870        
  4     40.2343300              0.2322410        
  5     12.8202100              0.4690700        
  6      4.3904370              0.3604550        
 L   3
  1     11.6263580             -0.1149610              0.0675800        
  2      2.7162800             -0.1691180              0.3239070        
  3      0.7722180              1.1458520              0.7408950        
 L   1
  1      0.2120313              1.0000000              1.0000000        
 L   1
  1      0.0639000              1.0000000              1.0000000  

"""  
O = """ S   6
  1   5484.6717000              0.0018311        
  2    825.2349500              0.0139501        
  3    188.0469600              0.0684451        
  4     52.9645000              0.2327143        
  5     16.8975700              0.4701930        
  6      5.7996353              0.3585209        
 L   3
  1     15.5396160             -0.1107775              0.0708743        
  2      3.5999336             -0.1480263              0.3397528        
  3      1.0137618              1.1307670              0.7271586        
 L   1
  1      0.2700058              1.0000000              1.0000000        
 L   1
  1      0.0845000              1.0000000              1.0000000        
 D   1
  1      0.8000000              1.0000000        

"""
 
S = """ S   6
  1  21917.1000000              0.0018690        
  2   3301.4900000              0.0142300        
  3    754.1460000              0.0696960        
  4    212.7110000              0.2384870        
  5     67.9896000              0.4833070        
  6     23.0515000              0.3380740        
 L   6
  1    423.7350000             -0.0023767              0.0040610        
  2    100.7100000             -0.0316930              0.0306810        
  3     32.1599000             -0.1133170              0.1304520        
  4     11.8079000              0.0560900              0.3272050        
  5      4.6311000              0.5922550              0.4528510        
  6      1.8702500              0.4550060              0.2560420        
 L   3
  1      2.6158400             -0.2503740             -0.0145110        
  2      0.9221670              0.0669570              0.3102630        
  3      0.3412870              1.0545100              0.7544830        
 L   1
  1      0.1171670              1.0000000              1.0000000        
 L   1
  1      0.0405000              1.0000000              1.0000000   
  
"""

F = """ S   6
  1   7001.7130900              0.0018196169     
  2   1051.3660900              0.0139160796     
  3    239.2856900              0.0684053245     
  4     67.3974453              0.233185760      
  5     21.5199573              0.471267439      
  6      7.40310130             0.356618546      
 L   3
  1     20.8479528             -0.108506975            0.0716287243     
  2      4.80830834            -0.146451658            0.3459121030     
  3      1.34406986             1.128688580            0.7224699570     
 L   1
  1      0.358151393            1.0000000              1.0000000        
 L   1
  1      0.1076000              1.0000000              1.0000000        
 D   1
  1      0.8000000              1.0000000 
  
"""
Cl = """ S   6
  1  25180.1000000              0.0018330        
  2   3780.3500000              0.0140340        
  3    860.4740000              0.0690970        
  4    242.1450000              0.2374520        
  5     77.3349000              0.4830340        
  6     26.2470000              0.3398560        
 L   6
  1    491.7650000             -0.0022974              0.0039894        
  2    116.9840000             -0.0307140              0.0303180        
  3     37.4153000             -0.1125280              0.1298800        
  4     13.7834000              0.0450160              0.3279510        
  5      5.4521500              0.5893530              0.4535270        
  6      2.2258800              0.4652060              0.2521540        
 L   3
  1      3.1864900             -0.2518300             -0.0142990        
  2      1.1442700              0.0615890              0.3235720        
  3      0.4203770              1.0601800              0.7435070        
 L   1
  1      0.1426570              1.0000000              1.0000000        
 L   1
  1      0.0483000              1.0000000              1.0000000        
 D   1
  1      0.7500000              1.0000000 
  
"""
Br = """ S   6
  1 439700.0000000              0.0008130        
  2  66030.0000000              0.0062850        
  3  15140.0000000              0.0319200        
  4   4317.0000000              0.1288000        
  5   1414.0000000              0.3946000        
  6    523.9000000              0.5413000        
 S   3
  1    523.9000000              0.1831000        
  2    207.7000000              0.6176000        
  3     86.5400000              0.2538000        
 S   1
  1     30.5200000              1.0000000        
 S   1
  1     12.9800000              1.0000000        
 S   1
  1      4.4120000              1.0000000        
 S   1
  1      1.8620000              1.0000000        
 S   1
  1      0.3932000              1.0000000        
 S   1
  1      0.1400000              1.0000000        
 P   3
  1   2957.0000000              0.0222600        
  2    700.3000000              0.1802000        
  3    224.6000000              0.8624000        
 P   3
  1     82.5900000              0.3440000        
  2     33.1900000              0.5071000        
  3     14.2000000              0.2590000        
 P   3
  1     14.2000000              0.0796500        
  2      7.4380000              0.3734000        
  3      3.5260000              0.6049000        
 P   1
  1      1.5950000              1.0000000        
 P   1
  1      0.8462000              1.0000000        
 P   1
  1      0.3186000              1.0000000        
 P   1
  1      0.1096000              1.0000000        
 D   4
  1    134.8000000              0.0183100        
  2     36.3900000              0.1350000        
  3     12.1600000              0.4261000        
  4      4.3410000              0.6043000        
 D   1
  1      1.5350000              1.0000000        
 D   1
  1      0.4510000              1.0000000  
  
"""
 
# BASIS SET DICTIONARY:
 
customA2 ={"Fe":FE, "C ":C, "H ":H, "N ": N, "O ": O, "S ":S, "F ":F, "Cl":Cl, "Br":Br}
#Fe = 6-31G 
#S  = 6-31++G 
#C  = 6-31G
#H  = 6-31G 
#N  = 6-31++G
#O  = 6-31++G
#F  = 6-31+G* 
#Cl = 6-31+G* 
#Br = 6-311G*

 
# Get file
fo = open(path, "r")	
lines =  fo.readlines()
fo.close()
	
# in file.inp: 
#	1) Erase $BASIS	.* $END\n line
#	2) For each line in the $DATA (skipping the first 2):
#		- get first letter
#		- go to list of elements
#		- if element exists: add corresponding BS
#		- else: print error message
# will need to read and write separately!

f = open(path,"w")

for line in lines:
	if line.startswith(" $BASIS"):
		print "\n...removing $BASIS ...  $END\n"
	
	elif re.match("(\w+)(\s+)(\d).*", line) is not None:	
		# found line with element and coordinates
		# C     6.0     5.36808    25.49591    20.49677
		element = line[0]+line[1]
		print element
		
		# write line, add BS after
		f.write(line)
		
		# find element in dictionary customA2
		if customA2.has_key(element):
			bs = customA2.get(element)
			f.write(bs)
		# else:
			# print "No such element in my Basis set: "+element

			
		
	else:
		f.write(line)
		
		
f.close()

print "I'm done. Please make sure I did no mistake!"

 
